(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{171:function(e,t,a){e.exports=a(405)},176:function(e,t,a){},181:function(e,t,a){},199:function(e,t,a){},200:function(e,t,a){},201:function(e,t,a){},202:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},403:function(e,t,a){},404:function(e,t,a){},405:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(70),s=a.n(l),i=a(1),o=a(4),c=a(6),u=a(5),p=a(7),h=a(3),m=a(30),d=(a(176),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(h.b,{to:"/"},r.a.createElement("header",null,r.a.createElement("h1",null,"SParty")))}}]),t}(n.Component)),y=(a(181),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",null,r.a.createElement("p",null,"Developed at Ironhack by Jota"))}}]),t}(n.Component)),g=a(43),f=a.n(g),E=function e(){var t=this;Object(i.a)(this,e),this.loggedin=function(){return t.service.get("/currentUser").then((function(e){return e.data}))},this.logout=function(){return t.service.get("/logout").then((function(e){return e.data}))},this.service=f.a.create({baseURL:"".concat("http://localhost:4000/api","/auth"),withCredentials:!0})},v=function e(){var t=this;Object(i.a)(this,e),this.getAllParties=function(){return t.service.get("/all").then((function(e){return e.data}))},this.getPartyDetails=function(e){return t.service.get("/"+e).then((function(e){return e.data}))},this.createParty=function(e){return t.service.post("/create",e).then((function(e){return e.data}))},this.updateParty=function(){return t.service.put("/:id").then((function(e){return e.data}))},this.deleteParty=function(e){return t.service.delete("/"+e).then((function(e){return e.data}))},this.service=f.a.create({baseURL:"".concat("http://localhost:4000/api","/parties")})},b=(a(199),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logout=function(){a.authService.logout().then((function(){a.setState({loggedInUser:null})}))},a.getUserParties=function(){a.partyService.getAllParties().then((function(e){a.setState({userParties:e.filter((function(e){return e.user===a.state.loggedInUser._id}))})}))},a.state={loggedInUser:a.props.user,userParties:[]},a.partyService=new v,a.authService=new E,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getUserParties()}},{key:"render",value:function(){var e=this;return this.state.loggedInUser?r.a.createElement("section",{className:"Home"},r.a.createElement("button",{className:"Logout",onClick:function(){return e.logout()}},"Log Out ",r.a.createElement("span",null,"x")),r.a.createElement("div",{className:"dashboard"},r.a.createElement("div",{className:"userInfo"},r.a.createElement("h2",null," Welcome ",this.state.loggedInUser.spotifyID),r.a.createElement("img",{src:this.state.loggedInUser.photo,alt:this.state.loggedInUser.username})),r.a.createElement("div",{className:"partiesSlider"},this.state.userParties.map((function(e){return r.a.createElement(h.b,{to:"/party/"+e._id},r.a.createElement("div",{className:"partyIcon"},r.a.createElement("img",{src:e.image_url,alt:e.name,height:"100"}),r.a.createElement("h5",null,e.name)))})))),r.a.createElement("div",{className:"newSparty"},r.a.createElement(h.b,{to:"/party/name"},r.a.createElement("button",null,r.a.createElement("h2",null,"New Sparty"))))):r.a.createElement(m.a,{to:"/"})}}]),t}(n.Component)),O=(a(200),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.service=new E,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("div",null,r.a.createElement("a",{href:"".concat("http://localhost:4000/api","/auth/spotify")},"Log In with Spotify")))}}]),t}(n.Component)),j=a(23),S=(a(201),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"CreateName"},""===this.props.party.name?r.a.createElement("h2",null,"New Sparty"):r.a.createElement("h2",null,this.props.party.name),r.a.createElement("label",{htmlFor:"name"},"Enter a name for your Sparty!"),r.a.createElement("input",{onChange:function(t){return e.props.updateName(t)},type:"text",placeholder:"New Sparty"}),r.a.createElement(h.b,{to:"/party/event"},r.a.createElement("button",{onClick:function(){return e.props.handleCreatePlaylist()}},r.a.createElement("h5",{className:"nextButton"},"Next"))))}}]),t}(n.Component)),k=(a(202),a(71)),C=a(35),P=a(170),D=a.n(P),I=a(50),U=a.n(I);U.a.setApiKey("AIzaSyD92RETtqglYn7VNcWrpHUj1F8EQqxjK9c"),U.a.enableDebug();var w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getCity=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0]&&"administrative_area_level_2"===e[t].types[0])return e[t].long_name},a.getArea=function(e){for(var t=0;t<e.length;t++)if(e[t].types[0])for(var a=0;a<e[t].types.length;a++)if("sublocality_level_1"===e[t].types[a]||"locality"===e[t].types[a])return e[t].long_name},a.getState=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)if(e[a].types[0]&&"administrative_area_level_1"===e[a].types[0])return e[a].long_name},a.onChange=function(e){a.setState(Object(k.a)({},e.target.name,e.target.value))},a.onInfoWindowClose=function(e){},a.onPlaceSelected=function(e){var t=e.formatted_address,n=e.address_components,r=a.getCity(n),l=a.getArea(n),s=a.getState(n),i=e.geometry.location.lat(),o=e.geometry.location.lng();a.setState({address:t||"",area:l||"",city:r||"",state:s||"",markerPosition:{lat:i,lng:o},mapPosition:{lat:i,lng:o}})},a.onMarkerDragEnd=function(e){console.log("event",e);var t=e.latLng.lat(),n=e.latLng.lng();U.a.fromLatLng(t,n).then((function(e){var t=e.results[0].formatted_address,n=e.results[0].address_components,r=a.getCity(n),l=a.getArea(n),s=a.getState(n);a.setState({address:t||"",area:l||"",city:r||"",state:s||""})}),(function(e){console.error(e)}))},a.state={address:"",mapPosition:{lat:a.props.center.lat,lng:a.props.center.lng},markerPosition:{lat:a.props.center.lat,lng:a.props.center.lng}},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;U.a.fromLatLng(this.state.mapPosition.lat,this.state.mapPosition.lng).then((function(t){var a=t.results[0].formatted_address,n=t.results[0].address_components,r=e.getCity(n),l=e.getArea(n),s=e.getState(n);console.log("city",r,l,s),e.setState({address:a||"",area:l||"",city:r||"",state:s||""})}),(function(e){console.error(e)}))}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.markerPosition.lat!==this.props.center.lat||this.state.address!==t.address||this.props.center.lat!==e.center.lat&&void 0}},{key:"render",value:function(){var e=this,t=Object(C.withScriptjs)(Object(C.withGoogleMap)((function(t){return r.a.createElement(C.GoogleMap,{google:e.props.google,defaultZoom:e.props.zoom,defaultCenter:{lat:e.state.mapPosition.lat,lng:e.state.mapPosition.lng}},r.a.createElement(D.a,{style:{width:"100%",height:"40px",paddingLeft:"16px",marginTop:"2px",marginBottom:"100px"},onPlaceSelected:e.onPlaceSelected}),r.a.createElement(C.Marker,{google:e.props.google,name:"Dolores park",draggable:!0,onDragEnd:e.onMarkerDragEnd,position:{lat:e.state.markerPosition.lat,lng:e.state.markerPosition.lng}}),r.a.createElement(C.Marker,null),r.a.createElement(C.InfoWindow,{onClose:e.onInfoWindowClose,position:{lat:e.state.markerPosition.lat+.0018,lng:e.state.markerPosition.lng}},r.a.createElement("div",null,r.a.createElement("span",{style:{padding:0,margin:0}},e.state.address))))})));return void 0!==this.props.center.lat?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"City"),r.a.createElement("input",{type:"text",name:"city",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.city})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Area"),r.a.createElement("input",{type:"text",name:"area",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.area})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"State"),r.a.createElement("input",{type:"text",name:"state",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.state})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:""},"Address"),r.a.createElement("input",{type:"text",name:"address",className:"form-control",onChange:this.onChange,readOnly:"readOnly",value:this.state.address}))),r.a.createElement(t,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyD92RETtqglYn7VNcWrpHUj1F8EQqxjK9c&libraries=places",loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:this.props.height}}),mapElement:r.a.createElement("div",{style:{height:"100%"}})})):r.a.createElement("div",{style:{height:this.props.height}})}}]),t}(r.a.Component),N=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"CreateEvent"},this.props.party?r.a.createElement("h2",null,this.props.party.name):r.a.createElement("h2",null,"New Party"),r.a.createElement("label",{htmlFor:"googleAddress"},"Main address:"),r.a.createElement("input",{type:"search",onChange:function(t){return e.props.updateAddress(t)}}),r.a.createElement("label",{htmlFor:"addressDeatails"},"Address Details:"),r.a.createElement("input",{onChange:function(t){return e.props.updateAddressDetails(t)},type:"text",placeholder:"Portal, floor, door,..."}),r.a.createElement("label",{htmlFor:"hour"},"Party starts at:"),r.a.createElement("input",{type:"time",onChange:function(t){return e.props.updateHour(t)}}),r.a.createElement(w,{google:this.props.google,center:{lat:40.4164481,lng:-3.7040234},height:"300px",zoom:12,party:this.props.party}),r.a.createElement("button",{onClick:function(){return e.props.handleCreateParty()}},r.a.createElement("h5",{className:"nextButton"},"Create")))}}]),t}(n.Component),x=(a(400),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,partyID:window.location.href.split("party/")[1]},a.partyService=new v,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"getPartyDetails",value:function(){var e=this;this.partyService.getPartyDetails(this.state.partyID).then((function(t){return e.setState(Object(j.a)({},e.state,{party:t}))}))}},{key:"componentDidMount",value:function(){this.getPartyDetails()}},{key:"render",value:function(){var e=this;return console.log(this.state),this.state.party&&this.state.loggedInUser?this.state.loggedInUser._id===this.state.party.user?r.a.createElement("section",null,r.a.createElement("nav",null,r.a.createElement("button",null,r.a.createElement(h.b,{to:"/home"},"Back")),r.a.createElement("button",null,r.a.createElement(h.b,{to:"/party/"+this.state.party._id+"/edit"},"Edit")),r.a.createElement("button",{onClick:function(){return e.props.deleteParty(e.state.partyID)}},"Delete")),r.a.createElement("h1",null,"Sparty | ",this.state.party.name),r.a.createElement("p",null,"Details: ",this.state.party.address,". ",this.state.party.addressDetails,", | Hour: ",this.state.party.hour),r.a.createElement("a",{href:"spotify:playlist:"+this.state.party.playlist},"Check the playlist on Spotify"),r.a.createElement("button",null,r.a.createElement(h.b,{to:"/party/"+this.state.party._id+"/share"},r.a.createElement("h1",null,"Share")))):void 0:this.state.party?r.a.createElement("section",null,r.a.createElement("h1",null,"Sparty Name: ",this.state.party.name),r.a.createElement("p",null,"Main Address: ",this.state.party.address),r.a.createElement("p",null,"Details: ",this.state.party.addressDetails),r.a.createElement("p",null,"Hour: ",this.state.party.hour),r.a.createElement("a",{href:"spotify:playlist:"+this.state.party.playlist},"Check the playlist on Spotify")):r.a.createElement("h1",null,"Loading...")}}]),t}(n.Component)),_=function e(){var t=this;Object(i.a)(this,e),this.createPlaylist=function(e,a,n){var r={Authorization:"Bearer "+n};return t.service.post("users/".concat(a,"/playlists"),e,{headers:r}).then((function(e){return e.data}))},this.service=f.a.create({baseURL:"https://api.spotify.com/v1/"})},A=(a(401),a(402),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,partyID:window.location.href.split("party/")[1].split("/edit")[0]},a.partyService=new v,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"getPartyDetails",value:function(){var e=this;this.partyService.getPartyDetails(this.state.partyID).then((function(t){return e.setState(Object(j.a)({},e.state,{party:t}))}))}},{key:"componentDidMount",value:function(){this.getPartyDetails()}},{key:"render",value:function(){return this.state.party&&this.state.loggedInUser?this.state.loggedInUser._id===this.state.party.user?r.a.createElement("section",null,r.a.createElement("nav",null,r.a.createElement("button",null,r.a.createElement(h.b,{to:"/party/"+this.state.partyID},"Cancel")),r.a.createElement("button",null,r.a.createElement(h.b,{to:"/party/"+this.state.party._id+"edit"},"Save changes")),r.a.createElement("button",null,"Delete")),r.a.createElement("h1",null,"Sparty | ",this.state.party.name),r.a.createElement("p",null,"Details: ",this.state.party.address,"."," ",this.state.party.addressDetails,", | Hour: ",this.state.party.hour),r.a.createElement("a",{href:"spotify:playlist:"+this.state.party.playlist},"Check the playlist on Spotify"),r.a.createElement("button",null,r.a.createElement(h.b,{to:"/party/"+this.state.party._id+"share"},r.a.createElement("h1",null,"Share")))):void 0:r.a.createElement("h1",null,"Loading...")}}]),t}(n.Component)),L=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,party:{user:a.props.user._id,userToken:a.props.user.token},playlistDetails:{public:!1,collaborative:!0},partyCreated:null},a.partyService=new v,a.spotifyService=new _,a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"updateName",value:function(e){var t=Object(j.a)({},this.state);t.party.name=e.target.value,t.playlistDetails.name=e.target.value,t.playlistDetails.description=e.target.value+". Made with SpartyTime",this.setState(t)}},{key:"updateAddress",value:function(e){var t=Object(j.a)({},this.state);t.party.address=e.target.value,this.setState(t)}},{key:"updateAddressDetails",value:function(e){var t=Object(j.a)({},this.state);t.party.addressDetails=e.target.value,this.setState(t)}},{key:"updateHour",value:function(e){var t=Object(j.a)({},this.state);t.party.hour=e.target.value,this.setState(t)}},{key:"createPlaylist",value:function(){var e=Object(j.a)({},this.state);this.spotifyService.createPlaylist(this.state.playlistDetails,this.state.loggedInUser.spotifyID,this.state.loggedInUser.token).then((function(t){e.party.playlist=t.id,e.party.image_url=t.images[0]})),this.setState(e)}},{key:"handleCreateParty",value:function(){var e=this;this.partyService.createParty(this.state.party).then((function(t){return e.setState(Object(j.a)({},e.state,{party:t,partyCreated:!0}),(function(){return e.props.history.push("/party/"+t._id)}))}))}},{key:"deleteParty",value:function(e){this.partyService.deleteParty(e).then((function(e){return console.log(e)})),this.props.history.push("/home")}},{key:"render",value:function(){var e=this;return r.a.createElement(m.d,null,r.a.createElement(m.b,{extact:!0,path:"/party/name",render:function(){return r.a.createElement(S,{updateName:function(t){return e.updateName(t)},handleCreatePlaylist:function(){return e.createPlaylist()},party:e.state.party})}}),r.a.createElement(m.b,{extact:!0,path:"/party/event",render:function(){return r.a.createElement(N,{updateAddress:function(t){return e.updateAddress(t)},updateAddressDetails:function(t){return e.updateAddressDetails(t)},updateHour:function(t){return e.updateHour(t)},party:e.state.party,handleCreateParty:function(){return e.handleCreateParty()}})}}),r.a.createElement(m.b,{extact:!0,path:"/party/:id/edit",render:function(){return r.a.createElement(A,{user:e.state.loggedInUser}," ")}}),r.a.createElement(m.b,{extact:!0,path:"/party/:id/share",render:function(){return r.a.createElement("h1",null," Share page ")}}),r.a.createElement(m.b,{extact:!0,path:"/party/:id",render:function(){return r.a.createElement(x,{user:e.state.loggedInUser,deleteParty:function(t){return e.deleteParty(t)}})}}))}}]),t}(n.Component),M=Object(m.g)(L),F=(a(403),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:null},a.authservice=new E,a.fetchUser(),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"fetchUser",value:function(){var e=this;return this.authservice.loggedin().then((function(t){e.setState({loggedInUser:t})})).catch((function(t){e.setState({loggedInUser:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loggedInUser?r.a.createElement(r.a.Fragment,null,r.a.createElement(d,null),r.a.createElement(m.d,null,r.a.createElement(m.b,{extact:!0,path:"/home",render:function(){return r.a.createElement(b,{user:e.state.loggedInUser})}}),r.a.createElement(m.b,{extact:!0,path:"/party",render:function(){return r.a.createElement(M,{user:e.state.loggedInUser,history:e.props.history})}}),r.a.createElement(m.b,{extact:!0,path:"/",render:function(){return r.a.createElement(h.b,{to:"/home"},r.a.createElement("button",null,r.a.createElement("h2",null,"Let's Sparty!")))}})),r.a.createElement(y,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(d,null),r.a.createElement(m.d,null,r.a.createElement(m.b,{extact:!0,path:"/login",render:function(){return r.a.createElement(O,null)}}),r.a.createElement(m.b,{extact:!0,path:"/party/:id",render:function(){return r.a.createElement(x,{user:e.state.loggedInUser})}}),r.a.createElement(m.b,{extact:!0,path:"/",render:function(){return r.a.createElement(h.b,{to:"/login"},r.a.createElement("button",null,r.a.createElement("h2",null,"Let's Sparty!")))}})),r.a.createElement(y,null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(404);s.a.render(r.a.createElement(h.a,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[171,1,2]]]);
//# sourceMappingURL=main.3d635fe7.chunk.js.map