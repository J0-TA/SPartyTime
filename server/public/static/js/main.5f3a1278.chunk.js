(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{33:function(e,t,a){e.exports=a(71)},38:function(e,t,a){},44:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(30),i=a.n(s),l=a(1),c=a(2),o=a(4),u=a(3),h=a(5),p=a(6),d=a(13),m=(a(38),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(p.b,{to:"/"},r.a.createElement("header",null,r.a.createElement("h1",null,"SParty")))}}]),t}(n.Component)),y=(a(44),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",null,r.a.createElement("p",null,"Developed at Ironhack by Jota"))}}]),t}(n.Component)),f=a(8),g=a(15),v=a.n(g),E=function e(){var t=this;Object(l.a)(this,e),this.loggedin=function(){return t.service.get("/currentUser").then((function(e){return e.data}))},this.logout=function(){return t.service.get("/logout").then((function(e){return e.data}))},this.service=v.a.create({baseURL:"".concat("https://spartytime.herokuapp.com/api","/auth"),withCredentials:!0})},b=function e(){var t=this;Object(l.a)(this,e),this.getAllParties=function(){return t.service.get("/all").then((function(e){return e.data}))},this.getPartyDetails=function(e){return t.service.get("/"+e).then((function(e){return e.data}))},this.createParty=function(e){return t.service.post("/create",e).then((function(e){return e.data}))},this.updateParty=function(e,a){return t.service.put("/"+e,a).then((function(e){return e.data}))},this.deleteParty=function(e){return t.service.delete("/"+e).then((function(e){return e.data}))},this.service=v.a.create({baseURL:"".concat("https://spartytime.herokuapp.com/api","/parties")})},S=(a(62),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).logout=function(){a.authService.logout().then((function(){a.setState({loggedInUser:null})}))},a.getUserParties=function(){a.partyService.getAllParties().then((function(e){a.setState({userParties:e.filter((function(e){return e.user===a.state.loggedInUser._id}))},a.updateAccessToken())}))},a.state={loggedInUser:a.props.user,userParties:[]},a.partyService=new b,a.authService=new E,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"updateAccessToken",value:function(){var e=Object(f.a)({},this.state);e.userParties=e.userParties.map((function(t){return t.userToken=e.loggedInUser.token})),this.setState(e)}},{key:"componentDidMount",value:function(){this.getUserParties()}},{key:"render",value:function(){var e=this;return this.state.loggedInUser?r.a.createElement("section",{className:"Home"},r.a.createElement("button",{className:"Logout",onClick:function(){return e.logout()}},"Log Out ",r.a.createElement("span",null,"x")),r.a.createElement("div",{className:"dashboard"},r.a.createElement("div",{className:"userInfo"},r.a.createElement("h2",null," Welcome ",this.state.loggedInUser.spotifyID),r.a.createElement("img",{src:this.state.loggedInUser.photo,alt:this.state.loggedInUser.username})),r.a.createElement("div",{className:"partiesSlider"},this.state.userParties.map((function(e,t){return r.a.createElement(p.b,{to:"/party/"+e._id,key:t},r.a.createElement("div",{className:"partyIcon"},r.a.createElement("img",{src:e.image_url,alt:e.name,height:"100"}),r.a.createElement("h5",null,e.name)))})))),r.a.createElement("div",{className:"newSparty"},r.a.createElement(p.b,{to:"/party/name"},r.a.createElement("button",null,r.a.createElement("h2",null,"New Sparty"))))):r.a.createElement(d.a,{to:"/"})}}]),t}(n.Component)),k=(a(63),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={},a.service=new E,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("div",null,r.a.createElement("a",{href:"".concat("https://spartytime.herokuapp.com/api","/auth/spotify")},"Log In with Spotify")))}}]),t}(n.Component)),O=(a(64),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"CreateName"},""===this.props.party.name?r.a.createElement("h2",null,"New Sparty"):r.a.createElement("h2",null,this.props.party.name),r.a.createElement("label",{htmlFor:"name"},"Enter a name for your Sparty!"),r.a.createElement("input",{onChange:function(t){return e.props.updateName(t)},type:"text",placeholder:"New Sparty"}),r.a.createElement(p.b,{to:"/party/event"},r.a.createElement("button",{onClick:function(){return e.props.handleCreatePlaylist()}},r.a.createElement("h5",{className:"nextButton"},"Next"))))}}]),t}(n.Component)),j=(a(65),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"CreateEvent"},this.props.party?r.a.createElement("h2",null,this.props.party.name):r.a.createElement("h2",null,"New Party"),r.a.createElement("label",{htmlFor:"googleAddress"},"Main address:"),r.a.createElement("input",{type:"search",onChange:function(t){return e.props.updateAddress(t)}}),r.a.createElement("label",{htmlFor:"addressDeatails"},"Address Details:"),r.a.createElement("input",{onChange:function(t){return e.props.updateAddressDetails(t)},type:"text",placeholder:"Portal, floor, door,..."}),r.a.createElement("label",{htmlFor:"hour"},"Party starts at:"),r.a.createElement("input",{type:"time",onChange:function(t){return e.props.updateHour(t)}}),r.a.createElement("button",{onClick:function(){return e.props.handleCreateParty()}},r.a.createElement("h5",{className:"nextButton"},"Create")))}}]),t}(n.Component)),P=(a(66),function e(){var t=this;Object(l.a)(this,e),this.createPlaylist=function(e,a,n){var r={Authorization:"Bearer "+n};return t.service.post("users/".concat(a,"/playlists"),e,{headers:r}).then((function(e){return e.data}))},this.searchSongs=function(e,a){var n={Authorization:"Bearer "+a};return t.service.get("search?q=".concat(e,"&type=track&limit=20"),{headers:n}).then((function(e){return e.data}))},this.addSongToPlaylist=function(e,a,n,r){console.log(e),console.log(a);var s={Authorization:"Bearer "+n},i={uris:[e]};t.service.post("users/".concat(r,"/playlists/").concat(a,"/tracks"),i,{headers:s}).then((function(e){return e.data}))},this.addSongToQueue=function(e,a){console.log(e),console.log(a);var n={Authorization:"Bearer "+a};t.service.post("https://api.spotify.com/v1/me/player/queue?uri=".concat(e),{headers:n}).then((function(e){return e.data}))},this.service=v.a.create({baseURL:"https://api.spotify.com/v1/"})}),C=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,partyID:window.location.href.split("party/")[1],foundedSongs:[]},a.partyService=new b,a.spotifyService=new P,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getPartyDetails",value:function(){var e=this;this.partyService.getPartyDetails(this.state.partyID).then((function(t){return e.setState(Object(f.a)({},e.state,{party:t}))}))}},{key:"searchSongs",value:function(e){var t=this;if(""===e.target.value)return this.setState(Object(f.a)({},this.state,{foundedSongs:[]}));this.spotifyService.searchSongs(e.target.value,this.state.party.userToken).then((function(e){return t.setState(Object(f.a)({},t.state,{foundedSongs:e.tracks.items}))}))}},{key:"addSong",value:function(e){this.spotifyService.addSongToQueue(e,this.state.party.userToken),this.spotifyService.addSongToPlaylist(e,this.state.party.playlist,this.state.party.userToken,this.state.party.user),console.log("added")}},{key:"componentDidMount",value:function(){this.getPartyDetails()}},{key:"render",value:function(){var e=this;return console.log(this.state),this.state.party&&this.state.loggedInUser?this.state.loggedInUser._id===this.state.party.user?r.a.createElement("section",null,r.a.createElement("nav",null,r.a.createElement("button",null,r.a.createElement(p.b,{to:"/home"},"Back")),r.a.createElement("button",null,r.a.createElement(p.b,{to:"/party/"+this.state.party._id+"/edit"},"Edit")),r.a.createElement("button",{onClick:function(){return e.props.deleteParty(e.state.partyID)}},"Delete")),r.a.createElement("h1",null,"Sparty | ",this.state.party.name),r.a.createElement("p",null,"Details: ",this.state.party.address,".",this.state.party.addressDetails,", | Hour: ",this.state.party.hour),r.a.createElement("a",{href:"spotify:playlist:"+this.state.party.playlist},"Check the playlist on Spotify"),r.a.createElement("label",{htmlFor:"search"},"Search: "),r.a.createElement("input",{className:"spotiSearch",type:"search",placeholder:"Add next song to the queue",onChange:function(t){return e.searchSongs(t)}}),r.a.createElement("div",{className:"searchResults"},this.state.foundedSongs.map((function(t,a){return r.a.createElement(r.a.Fragment,{key:a},r.a.createElement("img",{src:t.album.images[1].url,alt:t.album.name}),r.a.createElement("h3",null,t.name),r.a.createElement("h4",null,t.artists[0].name),r.a.createElement("audio",{controls:!0},r.a.createElement("source",{src:t.preview_url})),r.a.createElement("button",{onClick:function(){return e.addSong(t.uri)}},"Add to Sparty"))}))),r.a.createElement("div",{className:"socialShare"},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",className:"whatsapp",href:"https://web.whatsapp.com/send?text=Click to Sparty! "+encodeURI(window.location.href)},"Share via Whatsapp"),r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",className:"facebook",href:"https://www.facebook.com/sharer/sharer.php?u="+window.location.href},"Share via facebook"))):void 0:this.state.party?r.a.createElement("section",null,r.a.createElement("h1",null,"Sparty Name: ",this.state.party.name),r.a.createElement("p",null,"Main Address: ",this.state.party.address),r.a.createElement("p",null,"Details: ",this.state.party.addressDetails),r.a.createElement("p",null,"Hour: ",this.state.party.hour),r.a.createElement("a",{href:"spotify:playlist:"+this.state.party.playlist},"Check the playlist on Spotify")):r.a.createElement("h1",null,"Loading...")}}]),t}(n.Component),I=(a(67),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,partyID:window.location.href.split("party/")[1].split("/edit")[0]},a.partyService=new b,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"getPartyDetails",value:function(){var e=this;this.partyService.getPartyDetails(this.state.partyID).then((function(t){return e.setState(Object(f.a)({},e.state,{party:t}))}))}},{key:"updateParty",value:function(e,t){var a=Object(f.a)({},this.state);a.party[t]=e.target.value,this.setState(a)}},{key:"saveChanges",value:function(){var e=this;this.partyService.updateParty(this.state.partyID,this.state.party).then((function(t){return e.props.history.push("/party/"+e.state.partyID)}))}},{key:"componentDidMount",value:function(){this.getPartyDetails()}},{key:"render",value:function(){var e=this;return console.log(this.state),this.state.party&&this.state.loggedInUser?this.state.loggedInUser._id===this.state.party.user?r.a.createElement("section",null,r.a.createElement("nav",null,r.a.createElement("button",null,r.a.createElement(p.b,{to:"/party/"+this.state.partyID},"Cancel")),r.a.createElement("button",{onClick:function(){return e.props.deleteParty(e.state.partyID)}},"Delete")),r.a.createElement("label",null,"Sparty"),r.a.createElement("input",{type:"text",placeholder:this.state.party.name,onChange:function(t){return e.updateParty(t,"name")}}),r.a.createElement("label",null,"Details"),r.a.createElement("input",{type:"text",placeholder:this.state.party.address,onChange:function(t){return e.updateParty(t,"address")}}),r.a.createElement("input",{type:"text",placeholder:this.state.party.addressDetails,onChange:function(t){return e.updateParty(t,"addressDetails")}}),r.a.createElement("input",{type:"time",placeholder:this.state.party.hour,onChange:function(t){return e.updateParty(t,"hour")}}),r.a.createElement("button",null,r.a.createElement("h1",{onClick:function(){return e.saveChanges()}},"Save changes"))):void 0:r.a.createElement("h1",null,"Loading...")}}]),t}(n.Component)),D=(a(68),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:a.props.user,party:{user:a.props.user._id,userToken:a.props.user.token},playlistDetails:{public:!1,collaborative:!0}},a.partyService=new b,a.spotifyService=new P,a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"updateName",value:function(e){var t=Object(f.a)({},this.state);t.party.name=e.target.value,t.playlistDetails.name=e.target.value,t.playlistDetails.description=e.target.value+". Made with SpartyTime",this.setState(t)}},{key:"updateAddress",value:function(e){var t=Object(f.a)({},this.state);t.party.address=e.target.value,this.setState(t)}},{key:"updateAddressDetails",value:function(e){var t=Object(f.a)({},this.state);t.party.addressDetails=e.target.value,this.setState(t)}},{key:"updateHour",value:function(e){var t=Object(f.a)({},this.state);t.party.hour=e.target.value,this.setState(t)}},{key:"createPlaylist",value:function(){var e=Object(f.a)({},this.state);this.spotifyService.createPlaylist(this.state.playlistDetails,this.state.loggedInUser.spotifyID,this.state.loggedInUser.token).then((function(t){e.party.playlist=t.id,e.party.image_url=t.images[0]})),this.setState(e)}},{key:"handleCreateParty",value:function(){var e=this;this.partyService.createParty(this.state.party).then((function(t){return e.setState(Object(f.a)({},e.state,{party:t,partyCreated:!0}),(function(){return e.props.history.push("/party/"+t._id)}))}))}},{key:"deleteParty",value:function(e){var t=this;this.partyService.deleteParty(e).then((function(e){return t.props.history.push("/home")}))}},{key:"render",value:function(){var e=this;return r.a.createElement(d.d,null,r.a.createElement(d.b,{extact:!0,path:"/party/name",render:function(){return r.a.createElement(O,{updateName:function(t){return e.updateName(t)},handleCreatePlaylist:function(){return e.createPlaylist()},party:e.state.party})}}),r.a.createElement(d.b,{extact:!0,path:"/party/event",render:function(){return r.a.createElement(j,{updateAddress:function(t){return e.updateAddress(t)},updateAddressDetails:function(t){return e.updateAddressDetails(t)},updateHour:function(t){return e.updateHour(t)},party:e.state.party,handleCreateParty:function(){return e.handleCreateParty()}})}}),r.a.createElement(d.b,{extact:!0,path:"/party/:id/edit",render:function(){return r.a.createElement(I,{user:e.state.loggedInUser,deleteParty:function(t){return e.deleteParty(t)},history:e.props.history})}}),r.a.createElement(d.b,{extact:!0,path:"/party/:id",render:function(){return r.a.createElement(C,{user:e.state.loggedInUser,deleteParty:function(t){return e.deleteParty(t)}})}}))}}]),t}(n.Component)),w=Object(d.g)(D),U=(a(69),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={loggedInUser:null},a.authservice=new E,a.fetchUser(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"fetchUser",value:function(){var e=this;return this.authservice.loggedin().then((function(t){e.setState({loggedInUser:t})})).catch((function(t){e.setState({loggedInUser:!1})}))}},{key:"render",value:function(){var e=this;return this.state.loggedInUser?r.a.createElement(r.a.Fragment,null,r.a.createElement(m,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{extact:!0,path:"/home",render:function(){return r.a.createElement(S,{user:e.state.loggedInUser})}}),r.a.createElement(d.b,{extact:!0,path:"/party",render:function(){return r.a.createElement(w,{user:e.state.loggedInUser,history:e.props.history})}}),r.a.createElement(d.b,{extact:!0,path:"/",render:function(){return r.a.createElement(p.b,{to:"/home"},r.a.createElement("button",null,r.a.createElement("h2",null,"Let's Sparty!")))}})),r.a.createElement(y,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(m,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{extact:!0,path:"/login",render:function(){return r.a.createElement(k,null)}}),r.a.createElement(d.b,{extact:!0,path:"/party/:id",render:function(){return r.a.createElement(C,{user:e.state.loggedInUser})}}),r.a.createElement(d.b,{extact:!0,path:"/",render:function(){return r.a.createElement(p.b,{to:"/login"},r.a.createElement("button",null,r.a.createElement("h2",null,"Let's Sparty!")))}})),r.a.createElement(y,null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(70);i.a.render(r.a.createElement(p.a,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.5f3a1278.chunk.js.map